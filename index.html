<!DOCTYPE html>
<html>
<head>
  <title>Home | Aaron Panchal</title>
  <link href="http://fonts.googleapis.com/css?family=Gentium+Book+Basic|Montserrat:700|Playfair+Display:900,700italic" rel="stylesheet" type="text/css">
  <link href="build/styles.css" rel="stylesheet" type="text/css">
</head>
<body>
  <section>
    <div class="book">
      <div class="contents grid grid--v-centered">
        <div class="grid__item">
          <h1 class="title">Aaron</h1>
          <h2 class="subtitle">Panchal</h2>
        </div>
      </div>
      <div class="cover">
        <svg height="100%" width="100%" id="tiles"></svg>
      </div>
    </div>
  </section>

  <section>
    <h1 style="margin: 0;">About Me</h1>
  </section>

  <section>
    <h1 style="margin: 0;">Projects</h1>
  </section>
  <script src="vendor/snap.svg.js"></script>
  <script>
    window.onload = function () {
      document.querySelectorAll('.book')[0].className += ' is-open';
    };

    var paper = Snap('#tiles');
    var masterColors = [
      'rgb(0,78,27)',
      'rgb(245,172,183)',
      'rgb(83,30,0)',
      'rgb(232,50,0)',
      'rgb(250,249,252)',
      'rgb(4,4,5)',
      'rgb(45,113,187)',
      'rgb(253,231,0)',
      'rgb(195,146,0)'
    ];
    var triangleWidth = 167.44186,
        triangleHeight = 150;

    function drawTile(x, y, pointUp, color) {
      var shape;
      if (pointUp) {
        shape = paper.polygon(0, triangleHeight, triangleWidth / 2, 0, triangleWidth, triangleHeight);
      } else {
        shape = paper.polygon(0, 0, triangleWidth / 2, triangleHeight, triangleWidth, 0);
      }

      return shape.attr({
        fill: color,
        transform: 'translate(' + x + ',' + y + ')'
      });
    }

    function findExcluded(tiles, x, y) {
      var coords = [
        [x - 1, y],
        [x, y - 1],
        [x - 1, y - 1],
        [x + 1, y - 1],
        [x - 2, y - 1],
        [x - 2, y],
        [x + 2, y - 1]
      ];
      colorsToExclude = [];
      return coords.map(function (coord) {
        if ((coord[0] > -1) && (coord[1] > -1)) {
          return tiles[coord[1]][coord[0]];
        }
      });
    }

    function tile(width, height) {
      var numWide = Math.ceil(2 * width / triangleWidth) + 1,
          numHigh = Math.ceil(height / triangleHeight) + 1;

      tiles = [];

      for (var i = 0; i < numHigh; i++) {
        tiles[i] = [];
        for (var j = 0; j < numWide; j++) {
          var excluded = findExcluded(tiles, j, i);
          var colors = [0, 1, 2, 3, 4, 5, 6, 7, 8].filter(function (color) {
            return !(excluded.indexOf(color) + 1);
          });

          var color = colors[Math.floor(Math.random() * colors.length)];
          tiles[i][j] = color;

          drawTile(j * triangleWidth / 2 - triangleWidth / 2, i * triangleHeight, (i + j) % 2 - 1, masterColors[color]);

        }
      }

      return tiles;
    }

    tile(paper.node.getBoundingClientRect().width, paper.node.getBoundingClientRect().height);
  </script>
</body>
</html>
